import logging
import logging.config
import os
import yaml
from pathlib import Path


BASE_DIR = Path(__file__).resolve().parents[2]


def setup_logging(
    default_level=logging.INFO,
    env_key: str = "LOG_CFG",
    default_path: str = "configs/logging.yaml",
):
    """
    Setup logging configuration from YAML file.
    Priority:
    1. Environment variable (LOG_CFG)
    2. Default path (configs/logging.yaml)
    """

    config_path = os.getenv(env_key, default_path)
    config_file = BASE_DIR / config_path

    if config_file.exists():
        with open(config_file, "r", encoding="utf-8") as f:
            config = yaml.safe_load(f)
        logging.config.dictConfig(config)
    else:
        logging.basicConfig(level=default_level)
        logging.getLogger(__name__).warning(
            "Logging config file not found. Using basicConfig."
        )


def get_logger(name: str) -> logging.Logger:
    return logging.getLogger(name)
